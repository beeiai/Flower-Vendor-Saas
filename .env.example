# ==========================================
# SECURITY HARDENING - ENVIRONMENT VARIABLES
# ==========================================

# === REQUIRED FOR PRODUCTION ===
# Critical secrets - MUST be set in production
SECRET_KEY=change-this-to-a-very-long-random-string-at-least-32-characters
DATABASE_URL=postgresql://username:password@localhost:5432/database_name

# === OPTIONAL BUT RECOMMENDED ===
# Redis for distributed rate limiting (leave empty to use in-memory)
# Format: redis://[:password@]host:port[/database]
REDIS_URL=
ENABLE_DISTRIBUTED_RATE_LIMITING=false  # Set to true to enable Redis-based rate limiting

# === SECURITY CONFIGURATION ===
# Environment detection
ENVIRONMENT=development  # or production

# JWT Configuration
ACCESS_TOKEN_EXPIRE_MINUTES=120  # 2 hours
REFRESH_TOKEN_EXPIRE_DAYS=7

# Security validation
REQUIRE_SECURE_SECRETS=true

# === RATE LIMITING ===
# Authentication endpoints
AUTH_RATE_LIMIT=100
AUTH_RATE_WINDOW_SECONDS=60

# General API endpoints  
API_RATE_LIMIT=300
API_RATE_WINDOW_SECONDS=60

# === DATABASE POOLING ===
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# === CORS CONFIGURATION ===
# Comma-separated list of allowed origins
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://127.0.0.1:5173

# === SMS SERVICE (OPTIONAL) ===
SMS_API_URL=
SMS_API_KEY=
SMS_SENDER_ID=
SMS_MAX_RETRY=3

# === LOGGING ===
LOG_LEVEL=INFO

# === MASTER ADMIN CREDENTIALS ===
# Used for initializing the master admin account
# Initial credentials are stored in database after first use
# MASTER_ADMIN_USERNAME=your_username_here
# MASTER_ADMIN_PASSWORD_HASH=generate_with_password_hash.py

# ==========================================
# DEVELOPMENT NOTES:
# - Use 'change-me-in-prod' values only for local development
# - Never commit real secrets to version control
# - Generate SECRET_KEY with: python -c "import secrets; print(secrets.token_urlsafe(32))"
# ==========================================